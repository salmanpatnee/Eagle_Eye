<!DOCTYPE html5>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Primary Meta Tag  -->
    <title>Compliance 360</title>
    <meta name="title" content="Saturn-V GRC Tool">
    <meta name="description" content="Zain Cloud GRC Tool">
    <!-- Boxicons Icons-->
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="{{ asset('/css/6-Header/1-header.css') }}">
    <link rel="stylesheet" href="{{ asset('/css/7-Sidebar/1-Sidebar.css') }}">
    <link rel="stylesheet" href="{{ asset('/css/4-Process/2-Table/IndividualTable.css') }}">
    <style>
        .btn-link {
            background-color: transparent;
            border: none;
            font-size: 16px;
            cursor: pointer;
        }

        ol.resource-list {
            width: 480px;
        }

        ol.resource-list li {

            padding-block: .4em;
        }
    </style>
</head>

<body class="bg-white">


    <!-- SIDEBAR -->
    <section>
        <header>
            <div class="Header">
                <a href="/compliance" class="text-white">
                    <i class='bx bx-home'></i>
                </a>
                <p class="bold-arbtext">العمليات</p>
                <p class="bold-text">Processes</p>
                <i style="padding-right: 30px" class='bx bx-right-arrow-alt'></i>
                <div class="HeadingTxt">
                    <p class="ArbTxt">نتائج اختبار اختراق الثغرات</p>
                    <p class="EngTxt">Vulnerability Pen Test Findings</p>
                </div>
                @include('partials.roles')
                <div class="RightButtonContainer">
                    <button type="button" class="RightButton" onclick="goBack()">
                        <p>للخلف</p>
                        <p>Back</p>
                    </button>
                </div>
            </div>
        </header>
    </section>
    <!-- SIDEBAR -->



    <!-- CONTENT -->
    <div class="ContAssIndiTable">
        <div class="TableHeading">
            <div class="ButtonContainer">
                <a href="{{ route('pen-test.index') }}" class="MoreButton">
                    <p class="ButtonArbTxt">منظر</p>
                    <p class="ButtonEngTxt">View</p>
                </a>

                <a href="{{ route('pen-test-findings.create', $data->va_pt_test_id) }}"
                    class="{{ auth()->user()->can('manage-asset') ? 'MoreButton' : 'DisabledButton' }}">
                    <p class="ButtonArbTxt">يضيف</p>
                    <p class="ButtonEngTxt">Add</p>
                </a>
                <a href="{{ route($routeName . '.edit', $data->$primaryKey) }}"
                    class="{{ auth()->user()->can('manage-asset') ? 'MoreButton' : 'DisabledButton' }}">
                    <p class="ButtonArbTxt">تحديث</p>
                    <p class="ButtonEngTxt">Update</p>
                </a>
                <form method="POST" action="{{ route($routeName . '.delete') }}">
                    <input type="hidden" name="record" value="{{ $data->va_pt_finding_id }}">
                    <button type="submit"
                        class="{{ auth()->user()->can('delete-data') && auth()->user()->can('manage-asset') ? 'DeleteButton' : 'DisabledButton' }}">
                        <p class="ButtonArbTxt">يمسح</p>
                        <p class="ButtonEngTxt">Delete</p>
                    </button>
                    @csrf
                    @method('DELETE')
                </form>


            </div>
        </div>
        <table cellspacing="0">
       
            <div class="ContentTableSection">
                <p class="AssessmentHeadings">Vulnerability Pen Test Findings</p>
                <div class="ContentTable">
                    <div class="column">
                        <div class="MenuTxt">
                            <h3>رمز نتائج اختبار اختراق الثغرات</h3>
                            <span class="text">Finding ID</span>
                        </div>
                        <p class="sh-tx">{{ $penTestFinding->va_pt_finding_id }}</p>
                    </div>
                    <div class="column">
                        <div class="MenuTxt">
                            <h3>اسم نتائج اختبار اختراق الثغرات</h3>
                            <span class="text">Finding Name</span>
                        </div>
                        <p class="sh-tx">{{ $penTestFinding->va_pt_finding_name }}</p>
                    </div>
                </div>

                <div class="ContentTable">
                    <div class="column">
                        <div class="MenuTxt">
                            <h3>تاريخ الاكتشاف</h3>
                            <span class="text">Discovery Date</span>
                        </div>
                        <p class="sh-tx">{{ $penTestFinding->va_pt_discovery_date }}</p>
                    </div>
                    <div class="column">
                        <div class="MenuTxt">
                            <h3>تاريخ الإغلاق المتوقع</h3>
                            <span class="text">Expected Closure Date</span>
                        </div>
                        <p class="sh-tx">{{ $penTestFinding->va_pt_closing_date }}</p>
                    </div>
                </div>


                <div class="ContentTable">
                    <div class="column">
                        <div class="MenuTxt">
                            <h3>معرّف الثغرة الأمنية</h3>
                            <span class="text">CVEID</span>
                        </div>
                        <p class="sh-tx">{{ $penTestFinding->cveid }}</p>
                    </div>
                    <div class="column">
                        <div class="MenuTxt">
                            <h3>درجة تصنيف الثغرات الأمنية</h3>
                            <span class="text">CVSS Score</span>
                        </div>
                        <p class="sh-tx">{{ $penTestFinding->cvss_score }}</p>
                    </div>
                </div>


                <div class="ContentTable">
                    <div class="column">
                        <div class="MenuTxt">
                            <h3>حالة</h3>
                            <span class="text">Status</span>
                        </div>
                        <p class="sh-tx">{{ $penTestFinding->va_pt_status }}</p>
                    </div>
                    <div class="column">
                        <div class="MenuTxt">
                            <h3>حالة</h3>
                            <span class="text">Severity Level</span>
                        </div>
                        <p class="sh-tx">{{ $penTestFinding->severity_level }}</p>
                    </div>

                </div>

                <div class="ContentTable">

                    <div class="column">
                        <div class="MenuTxt">
                            <h3>اسم صاحب</h3>
                            <span class="text">Owner</span>
                        </div>
                        <p class="sh-tx">{{ $penTestFinding->owner?->owner_name }}</p>
                    </div>

                    <div class="column">owner_name
                        <div class="MenuTxt">
                            <h3>اسم الوصي</h3>
                            <span class="text">Custodians</span>
                        </div>
                        <ol class="resource-list">
                            @foreach ($penTestFinding->custodians as $custodian)
                                <li style="margin-left: 0">{{ $custodian->custodian_role_title }}</li>
                            @endforeach
                        </ol>

                    </div>


                </div>

                <div class="ContentTable">
                    <div class="column">
                        <div class="MenuTxt">
                            <h3>اسم الأصول</h3>
                            <span class="text">Assets</span>
                        </div>
                        <ol class="resource-list">
                            @forelse ($penTestFinding->assets as $asset)
                                <li style="margin-left: 0">{{ $asset->asset_name }}</li>
                            @empty
                                <li style="margin-left: 0">No assets found.</li>
                            @endforelse
                        </ol>

                    </div>

                    <div class="column">
                        <div class="MenuTxt">
                            <h3>اسم المجموعات الأصول</h3>
                            <span class="text">Asset Groups</span>
                        </div>
                        <ol class="resource-list">
                            @forelse ($penTestFinding->assetGroups as $assetGroup)
                                <li style="margin-left: 0">{{ $assetGroup->asset_group_name }}</li>
                            @empty
                                <li style="margin-left: 0">No asset groups found.</li>
                            @endforelse
                        </ol>

                    </div>

                    
                    
                    
                </div>
                <div class="ContentTable">
                    <div class="column">
                        <div class="MenuTxt">
                            <h3>اسم تصحيح</h3>
                            <span class="text">Patches</span>
                        </div>
                        <ol class="resource-list">
                            @foreach ($penTestFinding->patches as $patch)
                                <li style="margin-left: 0">{{ $patch->patch_name }}</li>
                            @endforeach
                        </ol>
    
                    </div>
                    <div class="column">
                        <div class="MenuTxt">
                            <h3>إجراءات التصحيح</h3>
                            <span class="text">Affected Systems</span>
                        </div>
                        <p class="sh-tx">{{ $penTestFinding->affected_systems }}</p>

                    </div>
                </div>

                <div class="ContentTable">
                    <div class="column">
                        <div class="MenuTxt">
                            <h3>الوصف</h3>
                            <span class="text">Description</span>
                        </div>
                        <div class="bg-tx">{!! html_entity_decode($penTestFinding?->va_pt_finding_description) !!}</div>
                    </div>
                </div>

                <div class="ContentTable">
                    <div class="column">
                        <div class="MenuTxt">
                            <h3>إجراءات المعالجة</h3>
                            <span class="text">Remediation Actions</span>
                        </div>
                        <p class="bg-tx">{{ $penTestFinding->remediation_actions }}</p>
                    </div>
                </div>

                <div class="ContentTable">
                    <div class="column">
                        <div class="MenuTxt">
                            <h3>تقييم التأثير</h3>
                            <span class="text">Impact Assessment</span>
                        </div>
                        <p class="bg-tx">{{ $penTestFinding->impact_assessment }}</p>
                    </div>
                </div>

                <div class="ContentTable">
                    <div class="column">
                        <div class="MenuTxt">
                            <h3>تحليل مسار الهجوم</h3>
                            <span class="text">Attack Path Analysis</span>
                        </div>
                        <p class="bg-tx">{{ $penTestFinding->attack_path_analysis }}</p>
                    </div>
                </div>

            </div>
        </table>

        <div class="ListTable">
            <table cellspacing="0">
                <tr>
                    <th style="padding-right: 0px;">
                        <p class="ListHeadArbTxt">رمز</p>
                        <p class="ListHeadEngTxt">S.No</p>
                    </th>
                    <th style="padding-right: 0px;">
                        <p class="ListHeadArbTxt">إثبات المفهوم</p>
                        <p class="ListHeadEngTxt">POC Name</p>
                    </th>
                    <th></th>
                </tr>
                @forelse ($penTestFinding->pocs as $poc)
                    <tr>
                        <td>{{ $loop->index + 1 }}</td>
                        <td>
                            {{ $poc->name }}
                        </td>
                        <td class="flex items-center justify-end">

                            <a class="btn-link me-2" href="{{ asset('storage/files/' . $poc->path) }}"
                                download>View</a>
                            &nbsp;&nbsp;&nbsp;&nbsp;
                            <form method="POST" action="{{ route('pen-test-findings.poc.destroy', $poc->id) }}">
                                @method('DELETE')
                                @csrf
                                <button class="btn-link" type="submit">Delete</button>
                            </form>

                        </td>
                    </tr>
                @empty
                    <tr>
                        <td colspan="3" class="text-center">
                            <p style="margin: 0">No attachments.</p>
                        </td>
                    </tr>
                @endforelse
            </table>
        </div>

    </div>


    <script src="/Css/4-Process/1-Form/1-Form.js"></script>
    <script src="/Css/7-Sidebar/2-Sidebar.js"></script>
    <script>
        function goBack() {
            window.history.back();
        }
    </script>
</body>

</html>
