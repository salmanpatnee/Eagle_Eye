@extends('4-Process/PenTestReport/layout')
@section('title', 'VA Pen Test Report')
@section('action-buttons')
    <a href="{{ route('pen-test-report', $penTest->va_pt_test_id) }}?pdf=1" class="btn-report">
        <p>تنزيل بصيغة بي دي إف</p>
        <p>Download as PDF</p>
    </a>
@endsection

@section('header')
    {{-- <h1 class="arabic-text">الهيئة الوطنية للأمن السيبراني - ضوابط الأمن السيبراني للأنظمة الحساسة</h1> --}}
    <p style="margin-top: 20px">Vulnerability Penetration Test Finding Report</p>
    {{-- <p>National Cybersecurity Authority - Critical Systems Cybersecurity Controls (NCA-CSCC)</p> --}}
@endsection
@section('content')



    @foreach ($penTest->findings as $finding)
        <table class="table">
            <tbody>
                {{-- Heads --}}
                <tr class="va-bg-{{ strtolower($finding->severity_level) }} text-left">
                    <th colspan="4">
                        <h2 class="mt-0 mb-0">{{ $finding->va_pt_finding_name }}</h2>
                    </th>
                </tr>
                <tr>
                    <th class="bg-light-gray">CVSS Score</th>
                    <td>{{ $finding->cvss_score }}</td>
                    <th class="bg-light-gray">CVEID </th>
                    <td>{{ $finding->cveid }}</td>
                </tr>
                <tr>
                    <th class="bg-light-gray">Affected Systems</th>
                    <td colspan="3">{{ $finding->affected_systems }}</td>
                </tr>
                <tr>
                    <th class="bg-light-gray">Description</th>
                    <td colspan="3">{!! html_entity_decode($finding?->va_pt_finding_description) !!}</td>
                </tr>
                <tr>
                    <th class="bg-light-gray">Remediation Actions</th>
                    <td colspan="3">{{ $finding?->remediation_actions }}</td>
                </tr>
                <tr>
                    <th class="bg-light-gray">POC</th>
                    <td colspan="3">
                        @forelse ($finding->pocs as $poc)
                            <div class="poc">
                                <img src="{{ asset('storage/files/' . $poc->path) }}" alt="">
                            </div>
                        @empty
                        @endforelse
                    </td>
                </tr>
                <tr>
                    <th class="bg-light-gray">Discovery Date</th>
                    <td>{{ $finding?->va_pt_discovery_date->format('d/m/Y') }}</td>
                    <th class="bg-light-gray">Expected Closure Date</th>

                    <td>{{ $finding?->va_pt_closing_date->format('d/m/Y') }}</td>
                </tr>
                <tr>
                    <th class="bg-light-gray">Remediation Actions</th>
                    <td colspan="3">{{ $finding?->remediation_actions }}</td>
                </tr>
                <tr>
                    <th class="bg-light-gray">Impact Assessment</th>
                    <td colspan="3">{{ $finding?->impact_assessment }}</td>
                </tr>
                <tr>
                    <th class="bg-light-gray">Attack Path Analysis</th>
                    <td colspan="3">{{ $finding?->attack_path_analysis }}</td>
                </tr>
                <tr style="border:none;">
                    <th style="border:none; padding-block: 20px;" colspan="4"></th>
                </tr>
            </tbody>
        </table>
    @endforeach




@endsection
